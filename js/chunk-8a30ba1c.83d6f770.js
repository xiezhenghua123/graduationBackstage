(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8a30ba1c"],{"51d2":function(t,e,a){},"827b":function(t,e,a){"use strict";a.r(e);var i=a("5530"),n=(a("d81d"),a("ac1f"),a("5319"),a("d3b7"),a("25f0"),a("f946")),r=a("365c"),l={data:function(){return{headerStyle:{"background-color":"rgba(0,0,0,0.05)"},data:[],page:1,total:0,limit:10,addData:{image:""},rules:{image:{required:!0,message:"请上传海报"}},dialogVisible:!1}},computed:{fileList:function(){return this.addData.image?[{url:this.addData.image}]:[]},pictureList:function(){return this.data.map((function(t){return t.image}))}},mounted:function(){this.getData()},methods:{getData:function(){var t,e=this;(t=this.page,Object(r.a)().get("banner/list/".concat(t))).then((function(t){e.data=t.bannerList,e.total=t.total,e.limit=t.limit}))},httpRequest:function(t){var e=this;Object(n.b)(t.file).then((function(t){e.addData.image=t}))},timeFormat:function(t){return t.replace(/T/g," ").replace(/\.[\d]{6}Z/g,"")},del:function(t){var e=this;(function(t){return Object(r.a)().delete("banner/".concat(t))})(t).then((function(){e.$message.success("删除成功！"),e.getData()}))},addBanner:function(){var t=this;this.$refs.ref.validate((function(e){e&&function(t){return Object(r.a)().post("banner/upload",t)}(Object(i.a)(Object(i.a)({},t.addData),{},{manager_id:sessionStorage.getItem("id").toString(),manager_name:sessionStorage.getItem("account")})).then((function(){t.$message.success("上传成功！"),t.getData(),t.dialogVisible=!1}))}))}}},o=(a("d8cc"),a("2877")),c=Object(o.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-fff p-10 height-100"},[a("el-button",{staticClass:"mb-10",attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" 点击上传 ")]),a("el-table",{attrs:{data:t.data,border:"","header-cell-style":t.headerStyle}},[a("el-table-column",{attrs:{prop:"id",label:"编号",width:"80"}}),a("el-table-column",{attrs:{label:"广告海报"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"50px",height:"30px"},attrs:{src:t.row.image,fit:"cover","preview-src-list":[t.row.image]}})]}}])}),a("el-table-column",{attrs:{prop:"manager_name",label:"发布管理员"}}),a("el-table-column",{attrs:{label:"发布时间","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.timeFormat(e.row.created_at))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popconfirm",{attrs:{title:"确认删除?","confirm-button-text":"确认","cancel-button-text":"取消"},on:{confirm:function(a){return t.del(e.row.id)}},scopedSlots:t._u([{key:"reference",fn:function(){return[a("el-button",{attrs:{type:"danger",size:"mini"}},[t._v(" 删除 ")])]},proxy:!0}],null,!0)})]}}])})],1),a("div",{staticClass:"mt-10 flex",staticStyle:{"justify-content":"right"}},[a("el-pagination",{attrs:{background:"",layout:"total,prev, pager, next","page-size":t.limit,"current-page":t.page,total:t.total},on:{"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.getData,"prev-click":t.getData,"next-click":t.getData}})],1),a("el-dialog",{attrs:{visible:t.dialogVisible,title:"添加广告","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){t.dialogVisible=!1}}},[a("el-form",{ref:"ref",attrs:{model:t.addData,"label-width":"auto",rules:t.rules}},[a("el-form-item",{attrs:{label:"海报",required:"",prop:"image"}},[a("el-upload",{staticClass:"upload-demo flex",attrs:{limit:1,action:"","http-request":t.httpRequest,"file-list":t.fileList,"list-type":"picture"}},[a("div",{staticClass:"upload-icon mr-10"},[a("i",{staticClass:"el-icon-plus"})])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.addBanner}},[t._v("提交")]),a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(" 取消 ")])],1)],1)],1)],1)}),[],!1,null,"80fea1ac",null);e.default=c.exports},d8cc:function(t,e,a){"use strict";a("51d2")},f946:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return r}));a("d3b7");var i=a("365c"),n=function(t){var e=new FormData;return e.append("image",t),t=e,Object(i.a)().post("/image",t,{headers:{"Content-Type":"multipart/form-data"}})},r=function(){return Object(i.a)().get("statistics")}}}]);