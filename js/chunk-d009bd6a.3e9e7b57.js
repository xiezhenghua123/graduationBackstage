(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d009bd6a"],{"0bb4":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a("365c"),i=function(t){return Object(n.a)().post("notice/add",t)}},a8cd:function(t,e,a){"use strict";a.r(e);var n=a("1da1"),i=a("5530"),r=(a("96cf"),a("d9e2"),a("a9e3"),a("d81d"),a("ac1f"),a("5319"),a("e9c4"),a("365c")),o=function(t,e){return Object(r.a)().put("appeal/".concat(t),e)},s=a("0bb4"),c=a("c24f"),l={data:function(){return{headerStyle:{"background-color":"rgba(0,0,0,0.05)"},dialogReasonVisible:!1,dialogRejectVisible:!1,rejectReason:{content:""},rejectRules:{content:{require:!0,message:"请填写理由",trigger:["blur","change"]}},dialogStatus:"",passRules:{points:{validator:function(t,e,a){"number"!=typeof e&&a(new Error("只能为数字")),(e<0||e>100)&&a(new Error("范围为0-100")),a()},transform:function(t){return Number(t)},trigger:["blur","change"]}},measures:{points:0},data:[],page:1,total:0,limit:10,dialogData:{}}},mounted:function(){this.getData()},methods:{getData:function(){var t,e=this;(t=this.page,Object(r.a)().get("appeal/list/".concat(t))).then((function(t){e.data=t.AppealList.map((function(t){return Object(i.a)(Object(i.a)({},t),{},{img:JSON.parse(t.img),time:t.created_at.replace(/T/g," ").replace(/\.[\d]{6}Z/g,"")})})),e.total=t.total,e.limit=t.limit}))},onSubmit:function(){var t=this;"pass"===this.dialogStatus?this.$refs.passForm.validate(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(a){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=22;break}return n=t.measures.points?"扣除信用分".concat(t.measures.points):"空",e.next=4,o(t.dialogData.id,Object(i.a)(Object(i.a)({},t.dialogData),{},{measure:n,img:JSON.stringify(t.dialogData.img),status:"3"}));case 4:if(1!=t.dialogData.toType){e.next=10;break}return e.next=7,Object(c.c)(t.dialogData.toId);case 7:r=e.sent.credit_score,e.next=13;break;case 10:return e.next=12,Object(c.b)(t.dialogData.toId);case 12:r=e.sent.credit_score.credit_score;case 13:return e.next=15,Object(c.d)(t.dialogData.toOpenid,{score:r-t.measures.points,type:t.dialogData.toType});case 15:return e.next=17,Object(s.a)({openid:t.dialogData.toOpenid,content:JSON.stringify({type:"complain",userType:t.dialogData.toType,content:"您已被投诉",id:t.dialogData.id,name:t.dialogData.fromName})});case 17:return e.next=19,Object(s.a)({openid:t.dialogData.fromOpenid,content:JSON.stringify({type:"complain",userType:t.dialogData.fromType,content:"您已投诉成功！",id:t.dialogData.id,name:t.dialogData.toName})});case 19:t.$message.success("提交成功！"),t.getData(),t.dialogReasonVisible=!1;case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):this.$refs.rejectForm.validate(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return o(t.dialogData.id,Object(i.a)(Object(i.a)({},t.dialogData),{},{img:JSON.stringify(t.dialogData.img),status:"4"})),e.next=4,Object(s.a)({openid:t.dialogData.fromOpenid,content:JSON.stringify({type:"complain",userType:t.dialogData.fromType,content:"投诉失败！".concat(t.rejectReason.content),id:t.dialogData.id,name:t.dialogData.toName})});case 4:t.getData(),t.$message.success("提交成功！"),t.dialogRejectVisible=!1;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handle:function(t,e){"pass"===e?this.dialogReasonVisible=!0:this.dialogRejectVisible=!0,this.dialogStatus=e,this.dialogData=Object(i.a)({},t)}}},u=a("2877"),d=Object(u.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-fff"},[a("div",{staticClass:"p-10"},[a("el-table",{attrs:{data:t.data,"header-cell-style":t.headerStyle,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"编号",width:"60"}}),a("el-table-column",{attrs:{prop:"fromName",label:"投诉人",width:"80"}}),a("el-table-column",{attrs:{label:"被投诉人",prop:"toName",width:"80"}}),a("el-table-column",{attrs:{prop:"work",label:"涉及岗位(工作标题)",width:"150"}}),a("el-table-column",{attrs:{prop:"content",label:"投诉原因","min-width":"150"}}),a("el-table-column",{attrs:{prop:"file",label:"附件",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.img.length?a("div",{staticClass:"flex",staticStyle:{"flex-wrap":"wrap"}},t._l(e.row.img,(function(t,n){return a("el-image",{key:n,staticClass:"ml-10",staticStyle:{width:"50px",height:"30px"},attrs:{src:t,fit:"cover","preview-src-list":e.row.img}})})),1):a("div",[t._v("无")])]}}])}),a("el-table-column",{attrs:{prop:"time",label:"投诉时间",width:"160"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["3"==e.row.status?a("div",[t._v("已通过")]):"4"==e.row.status?a("div",[t._v("已拒绝")]):"5"==e.row.status?a("div",[t._v("用户已撤销")]):a("div",{staticClass:"flex"},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.handle(e.row,"pass")}}},[t._v(" 通过 ")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handle(e.row,"reject")}}},[t._v(" 拒绝 ")])],1)]}}])})],1),a("div",{staticClass:"mt-10 mb-10 flex",staticStyle:{"justify-content":"right"}},[a("el-pagination",{attrs:{background:"",layout:"total,prev, pager, next","page-size":t.limit,"current-page":t.page,total:t.total},on:{"update:pageSize":function(e){t.limit=e},"update:page-size":function(e){t.limit=e},"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.getData,"prev-click":t.getData,"next-click":t.getData}})],1),a("el-dialog",{attrs:{title:"选择惩罚措施",visible:t.dialogReasonVisible},on:{"update:visible":function(e){t.dialogReasonVisible=e}}},[a("el-form",{ref:"passForm",attrs:{inline:"",model:t.measures,rules:t.passRules,"label-width":"auto"}},[a("el-form-item",{staticClass:"ml-10",attrs:{prop:"points",label:"扣除信用分(满分100分)："}},[a("el-input",{model:{value:t.measures.points,callback:function(e){t.$set(t.measures,"points",e)},expression:"measures.points"}})],1)],1),a("div",{staticClass:"flex"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),a("el-button",{on:{click:function(e){t.dialogReasonVisible=!1}}},[t._v("取消")])],1)],1),a("el-dialog",{attrs:{title:"选择拒绝理由",visible:t.dialogRejectVisible},on:{"update:visible":function(e){t.dialogRejectVisible=e}}},[a("el-form",{ref:"rejectForm",attrs:{model:t.rejectReason,rules:t.rejectRules,"label-width":"auto"}},[a("el-form-item",{attrs:{required:"",prop:"content",label:"拒绝理由："}},[a("el-input",{model:{value:t.rejectReason.content,callback:function(e){t.$set(t.rejectReason,"content",e)},expression:"rejectReason.content"}})],1)],1),a("div",{staticClass:"flex"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),a("el-button",{on:{click:function(e){t.dialogRejectVisible=!1}}},[t._v("取消")])],1)],1)],1)])}),[],!1,null,null,null);e.default=d.exports},c24f:function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return c})),a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return s}));var n=a("365c"),i=function(t,e){return Object(n.a)().get("user/list/".concat(e),{params:{type:t}})},r=function(t,e){return Object(n.a)().put("".concat(t,"/update"),e)},o=function(t){return Object(n.a)().get("worker/".concat(t))},s=function(t){return Object(n.a)().get("company/".concat(t))},c=function(t,e){return Object(n.a)().put("".concat(t,"/updateScore"),e)}}}]);